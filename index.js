(function () {
  const _0x65f9a7a = (function () {
    let _0x3e1f7c = !![];
    return function (_0xc2e3, _0x1f158) {
      const _0x7545cf = _0x3e1f7c
        ? function () {
            if (_0x1f158) {
              const _0x70d609a = _0x1f158["apply"](_0xc2e3, arguments);
              _0x1f158 = null;
              return _0x70d609a;
            }
          }
        : function () {};
      _0x3e1f7c = ![];
      return _0x7545cf;
    };
  })();

  const _0xd985b = _0x65f9a7a(this, function () {
    const _0x792e8 = function () {
      let _0x084d4e0;
      try {
        _0x084d4e0 = Function(
          'return (function() {}.constructor("return this")( ))',
        );
      } catch (e) {
        _0x084d4e0 = window;
      }
      return _0x084d4e0;
    };
    const _0x084d4e0 = _0x792e8();
    const _0xe41b21 = (_0x084d4e0["console"] = _0x084d4e0["console"] || {});
    const _0xcef4 = [
      "log",
      "warn",
      "info",
      "error",
      "exception",
      "trace",
      "debug",
    ];
    for (let i = 0; i < _0xcef4["length"]; i++) {
      const _0x8bef14 =
        _0x65f9a7a["constructor"]["prototype"]["bind"](_0x65f9a7a);
      const func = _0xcef4[i];
      const orig = _0xe41b21[func] || _0x8bef14;
      _0x8bef14["__proto__"] = _0x65f9a7a["bind"](_0x65f9a7a);
      _0x8bef14["toString"] = orig["toString"]["bind"](orig);
      _0xe41b21[func] = _0x8bef14;
    }
  });
  _0xd985b();
})();

(function () {
  let _0x65f9a7a = !![];
  setInterval(
    function () {
      if (_0x65f9a7a) {
        (function () {
          return !![];
        })
          ["constructor"]("debugger")
          ["call"]("action");
      } else {
        (function () {
          return ![];
        })
          ["constructor"]("debugger")
          ["apply"]("stateObject");
      }
      _0x65f9a7a = !_0x65f9a7a;
    },
    Math.random() * 2000 + 1000,
  );
})();

(function () {
  const _0x65f9a7a = function () {
    let _0x3e1f7c = new Date().getTime();
    debugger;
    let _0xc2e3 = new Date().getTime();
    if (_0xc2e3 - _0x3e1f7c > 100) {
      console.log = function () {};
    }
  };
  try {
    setInterval(_0x65f9a7a, Math.random() * 5000 + 3000);
  } catch (e) {}
})();

const _0x65c29 = {
  _db90d8f5: function (_0xfb9b4c) {
    const _0xf8db824 = _0xfb9b4c % 0xfa;
    return _0xf8db824 ^ 0x8f;
  },
  _eddf3: function (_0xfb9b4c, _0xf8db824) {
    return _0xfb9b4c % _0xf8db824 ^ 0xd07;
  },
};

const _0x0885 = {
  _dbbef9ac: function (_0xf7d6) {
    const _0xc132 = _0xf7d6 * 0x73;
    return _0xc132 + 0x61;
  },
  _e81834: function (_0xf7d6, _0xc132) {
    return _0xf7d6 * _0xc132 + 0x6b3;
  },
};

const _0x9d8c3c = {
  _d256e3e: function (_0xfeefc) {
    const _0x9e460d6 = _0xfeefc / 0xc2;
    return _0x9e460d6 + 0x85;
  },
  _e06aa: function (_0xfeefc, _0x9e460d6) {
    return _0xfeefc / _0x9e460d6 + 0x41f;
  },
};

const _0x7fbc2a = {
  _d48d3a19: function (_0x69486ac) {
    const _0xddff = _0x69486ac & 0xaa;
    return _0xddff & 0xfd;
  },
  _e3e9b: function (_0x69486ac, _0xddff) {
    return _0x69486ac & _0xddff & 0x41b;
  },
};

const _0x2b030f9 = {
  _d2389556: function (_0xded08eb) {
    const _0xd0a1aa = _0xded08eb | 0x38;
    return _0xd0a1aa + 0xf;
  },
  _e46b2133: function (_0xded08eb, _0xd0a1aa) {
    return (_0xded08eb | _0xd0a1aa) + 0x2;
  },
};

const _0x6d329 = {
  _dd888: function (_0x0252) {
    const _0x2107 = _0x0252 | 0xbd;
    return _0x2107 * 0xbf;
  },
  _ebacb783: function (_0x0252, _0x2107) {
    return (_0x0252 | _0x2107) * 0x2b2;
  },
};

const _0xadb7a = {
  _d24cb8f: function (_0x5702ab) {
    const _0xc515ca4 = _0x5702ab / 0xaf;
    return _0xc515ca4 % 0xc5;
  },
  _ecbc91: function (_0x5702ab, _0xc515ca4) {
    return (_0x5702ab / _0xc515ca4) % 0x1d0;
  },
};

const _0xa8bc608 = {
  _d84d795: function (_0xe1500e) {
    const _0xcd9f4ba = _0xe1500e ** 0x6f;
    return _0xcd9f4ba | 0x49;
  },
  _e28190c0: function (_0xe1500e, _0xcd9f4ba) {
    return (_0xe1500e ** _0xcd9f4ba) | 0x42e;
  },
};

const _0x8f774 = {
  _d4dee490: function (_0x5f645da) {
    const _0x9326 = _0x5f645da % 0x7d;
    return _0x9326 + 0xd2;
  },
  _e3408c: function (_0x5f645da, _0x9326) {
    return (_0x5f645da % _0x9326) + 0x14f;
  },
};

const _0x934d9 = {
  _d513f: function (_0x2ac5fe4) {
    const _0xa2cd54 = _0x2ac5fe4 << 0x9d;
    return _0xa2cd54 & 0xf5;
  },
  _efd6c: function (_0x2ac5fe4, _0xa2cd54) {
    return (_0x2ac5fe4 << _0xa2cd54) & 0x8e2;
  },
};

const _s6551b = [
  "4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQ4pWV4pWX4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB",
  "PzBhMGw=",
  "eCNpOH8kLndhdSJ2fS9gPSMnNjIlZmVjIX4OPm1tYHp8cCQnZGVxeSBpfjM3IFwyNmQwLng=",
  "ADbimqDvuZMnJFE+NGlndj01cz0jKSE2I2t3biZpNnBnZSV0OSp2OXUl",
  "eCNpOH8kLndhdSJ28KmCpSN4LGAhNjwtcn48YyQzeC5rZjE9fQBp",
  "fHgg8KiThSRONiRtazkrPSN8dyl1c2sjJnc6czQ9ImNkczk/by5+eQ==",
  "8KiljiAeSFAlEgJJXwYYF0Z8eikdEgJKTiwQQhpwXFJKQwkTIBhOV04YHigndgoATB8cKQEcGkxeYg==",
  "Pzl0OWBrdy4PeH45PiZmLyQ=",
  "ET1tLHVrdjIjJiJ4",
  "eCNBDE5bRxYDTVMDCxh+czZ5PHwyYnZpNGgjOWlz",
  "fHgg8KiToSRWHAUoLHZ5dCN8dyl1c2sjJnc6czQ9InB3aDgtYygpd24iLVRi",
  "ET1uO2JnYDxwe3g5MnRzLjhtIDh/LSw=",
  "DDFsNW8kazg9Z352MjV3OTBmJzpxKzIsJmklJWcgdmIxLWF1PSQ=",
  "DDlzKG5vZDlwe2kkLzFxfBZZHHMzZnBmMmswPiJcaw==",
  "LCpvOHJncSQPbmMjNzA=",
  "fHgg8KiStyRNNiJvbXYXO3ExNmV1c2sjJnc1aCM9bXRXciwxYTQvbXEyPSZ8JDYwdj8jJyUhOGBnJS4=",
  "8KiSnSAeYnZpNjt9LD4wOmQ7NjN1dypmenw6dTQjTXQrczMUbz9maGATMXxpBS0majIwIXc6NS5LSHEuLA==",
  "fHggfCckJXdw8J2TgXYYOGIxNn11c2sjJncgcz4iaS5kYzgqZS90eQ==",
  "4o6seFc9bHBwdwNtYDMqNWp8dyl1c3EjOCx3fDI4bWxuKT8hYTIvamAgcExtIjx8dzU6bCYnMG5yJX1zPhxjY2RrOQt0Lm5qYn9yYWh7EBAhdX50",
  "ODl0PQ==",
  "LCpvP2J3dj4+bw==",
  "8KiljiAeSFAlEgJJXwYYF0Z8eikWFhojUl4cQwQbLERMVBcXTnwsJFYDH0tHdg0bSBM=",
  "DzFsPWxla3c9aX8jMj9iMndIBRpxSGd1c2MwImUgR2goNmUvbmU/",
  "4pyQeFQ1Y2VudzFsbXYpJmw4ImJ1NzhwaWM9JzU1YmdkaXwrdDNkbyUjNXp/Mz09YnwzYHUnPmhtLCdiIzRpa2RzADY=",
  "4pu877mXIHxCdnc4IihhMzQ2Yj82KTM6PWYibSNuOjV1LnF/KA==",
  "ODduOQ==",
  "DiggeHxlaDglZnh4LTtPMzRoOTYCd3BlPWB5cmVkKE4Yeikh",
  "8KiSviAMdWthIjsoSD8qP2wydyl1c3EjIjZzIyozZGFpbHIhZTBra3J/I3xtIip6dzMjaDkDI2xmeTBzInlx",
  "fHgg4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQ4pWV4pWX4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQWWk=",
  "ADbimqDvuZMnJFcyIX1pJS10dzU6bDomJSI=",
  "4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQ4pWV4pWX4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSBDGI=",
  "PShpN2J9KyMofA==",
  "ADbimqDvuZMnJEQHGShHMyB0dT07YDFzJWJyZXNgMDdtbCVjNStpMXdla3lwSWc3N3R3OSNoJXM1amV5PWY6MWIuWWk=",
  "fHgg8KiThSRONiRtazkrPSN8dyl1c2sjJnc6czQ9ImNkczk/by5+eVk5",
  "fHgg8KiStyRNNiJvbXYXO3ExNmV1c2sjJnc1aCM9bXRXciwxYTQvbXEyPSZ8JDYwdj8jJyUhOGBnJS5bPw==",
  "fHgg8KiUoiRNNiJvbXYdPXA3OGd1c2sjJnc1aCM9bXRXciwxYTQvbXEyPSZ8JDYwdj8jJyYjNGBrbT9YISJlY2AuIQRu",
  "OD1mPXJocQ==",
  "4pyQeFA1a21tNj4oeD89NWh8IWg5OjUi",
  "GQxJEUJASgIE",
  "ADbwn5WYJ0lgOiZpYD89NXA1d0gFGnFIZ3V9KX8=",
  "ADYgfCckJXd0c38iNiZmFTNxdXhxMn8ic+KcgnF0d3NxaC49LjJmaWAqDGY=",
  "eCNjPXNhYjgicV86LDN+A3NyMTIlZlF4IXoOdHd0bGo5C3QueipxLyQ=",
  "NCx0LHQ+KngxeGV4MCRqOi4nOiE2PGRjIWowJDFqdmgy",
  "fHgg4pWc4pSH4pSE4pSF4pWX4pWQ4pSI4pSM4pWW4pWZ4pWU4pSD4pWc4pWX4pSJ4pWV4pWT4pWR4pSD4pSC4pSM4pWT4pSH4pWR4pWQ4pSM4pSA4pSF4pSH4pWc4pWY4pSA4pWc4pSH4pSE4pSF4pWX4pWQ4pSI4pSM4pWW4pWZ4pWU4pSD4pWc4pWX4pSJ4pWV4pWT4pWR4pSD4pSC4pSM4pWT4pSH",
  "PzBlP2xtazAPe3g5Oj8=",
  "ADYgfCfwnpOIdwNcQxUSdFcZBVoQFxhCIkgaJ3UrZXRganI5dj1uaGQ1PG1fIjYmZi95ZTA9NndqcXNTHhtDOg==",
  "8KiViSARYmlwNiQoTQYQdEg5Lid7fQ==",
  "fHgg4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQ4pWV4pWX4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQ",
  "8KiSmiAMTkhMH3BDTQIcE0wOHikFAR5HV0c=",
  "fHgg8KiOjiRBHgNDQxh5dCN8dyl1c2sjJnc6czQ9ImRsdD83dTJzeSB3H05KCjc=",
  "ADbimqDvuZMnJEQHGShHMyB0dzUzaD5zJ2JuZTcnMCRtdSViJChpLmJgJA==",
  "8KiSmiARYmpiNj1qZTp5MGI6I2gnczpidmk0aCM5Ii4rWzI=",
  "fHggfCckJXdw8J2Tg3YTNXE9PCl1c2sjJncgcz4iaS5hbi8sYTJkYXh3O2U=",
  "EDdhOG5qYnl+Jg==",
  "HzlyPT0kbTYgfX92Pz1vOXdoJTo6ZnsiJ38lfCxsZGspeGo9a2VrPDFmLDQ2ICMwNm48fQ1t",
  "8KiOr++4j3wnTEQEGUQsBgsbRwkcKREaAkhNQnNDFB5LQUsnDwxPH0wkURICW0kSEBU=",
  "OSpyM3U=",
  "ADbinIV8TGVxMjdnfj95MGosPmU8O2sjJncgYj01b3RgYx85dDlga3cufmttIjwzbC4uVjsyPGZ/UD0=",
  "4p2ZeFQzc2VpbXAsdzI4IGJyO2w7NCVrfywjdT40eWslYzk2Zz1pJHYjP2tndi0xcS8ybTwyDW1eYg==",
  "fHgg8KiOjiRBHgNDQxh5dCN8dyl1c2sjJnc6czQ9ImRsdD83dTJzeSB3H05K",
  "eCNBDE5bRxYDTVMDCxh+czZ5PHwya2dvOCo1OX9janIyLA==",
  "ADbinYx8RlRMdxttdXYtPWc9PCk3PD1maiw4aCI/YmckWzI=",
  "8KiViSAdV00lHBVRLAIQEEIXd00cBxROV0cSSQ==",
  "8KiTpiAUZndsO3BsZSUwOXM9OSk+NmsjJnc1bj01XGFxbyEEbg==",
  "ETlzKWxvZDlwRGM4Pj13KTNsdXsybGx4PG9rcD0xMCltYDBuMzUsbXA=",
  "DzFsPWxla3czZ243eThiOz4pMTY/ZGNic0YBGSxLYH58IWEyYCRnMj5pfngFOg==",
  "fHggfCckJXdw8J2Tg3YTNXE9PCl1c2sjJncgcz4iaS5hbi8sYTJkYXh3O2VQOA==",
  "fHggCmJ2dj4/ZiwUNiAjGSVoJiMwYGc2czZ/YCIwWWk=",
  "8KiSmiAXZnBgMD96ZWx5cHg/Nn0wND5xe0IyajQtUG4=",
  "HzduKGJqcXoEcXwz",
  "OjFnMGJw",
  "8KiPtyARQklVBR9bSQV5BEYSFEgHGhBNIlwBSBUFRyBBTg8TTxIpKis=",
  "ET1zL2ZjYG0=",
  "4pyQeFQ1Y2VudzFsbXYpJmw4ImJ1NzhwaWM9JzU1YmdkaXwrdDNkbyUjNXp/Mz09YgA5",
  "HQhJfExhfHckYWg3MnR1PTtgMQ==",
  "4pyQeEY9c2VpdzV6fjkrbg==",
  "LyxvLmJ3",
  "ODl0PT0k",
  "fHgg4pWc4pSH4pSE4pSF4pWX4pWQ4pSI4pSM4pWW4pWZ4pWU4pSD4pWc4pWX4pSJ4pWV4pWT4pWR4pSD4pSC4pSM4pWT4pSH4pWR4pWQ4pSM4pSA4pSF4pSH4pWc4pWY4pSA4pWc4pSH4pSE4pSF4pWX4pWQ4pSI4pSM4pWW4pWZ4pWU4pSD4pWc4pWX4pSJ4pWV4pWT4pWR4pSD4pSC4pSM4pWT4pSHDT5Qbg==",
  "4p2ZeFQzc2VpbXAsdyYrO2cpNH0mfT1mbGsnbyxwfHJqYykzIDhud244PihoMzczYjJ3eiE8MmgieDZ1IjVoaWQ=",
  "fHggD2h3aDI0KDZ2PzYtPzhkejIjamdgIGIhJGVhazZuYQ==",
  "FDlwKXQkYz48bSw3KT1oOS4nISslI2ZtPScyP25hJWs9P2l8Y2FrMDFmLBcJHSMXMnB1MTBxdyIPaQ==",
  "LyxyOWZp",
  "Dx1NCUZbThYETUsZCx0=",
  "PSBpM3Q=",
  "ADbinYx8TGtqJTRhYjctdHc1M2g+cydibmU3JnEYbXJwdHw6ZS5ydGR3MWZrPTh6XzI=",
  "HQhJfExhfG1w",
  "fHgg8KiUoiRNNiJvbXYdPXA3OGd1c2sjJnc1aCM9bXRXciwxYTQvbXEyPSZ8JDYwdj8jJyYjNGBrbT9YISJlY2AuIQ==",
  "Pzl0OWBrdz41ew==",
  "Lj1hOGttazJ9e3U4Og==",
  "ADYgfCdHdzIxfGkyeTZ6fG0pFCE4Zm4sAGIhJGVhaw==",
  "ET1uO2ZpZz48KGc3LTFkMyVge31/",
  "Lj1zKWtw",
  "NCx0LHQ+Kng1em0lKTVgOXlrOic/ZnFlMikyP2E=",
  "CDFkPWwkYTYgaXh2LTFxNCJrID02I2lpc0U+JGJldm49diAfaGZkdzxpaz95OmIyI2B7",
  "ADYkJ25gfXd7KD0rd3Twn6Ktdy0uOiVmbyIjdT40eWNxKTI5bTl6",
  "8KiSlSAIaG9qdwRtfjI8P2Iodyl1c3EjIjZzIyozZGFpbHIhZTBra3J/I3xtIip6dzMjaDkAJWxwaSAuLA==",
  "bHYg8KiMmCRWEh1dTXYSFVcZEEYHGnErQ2Exbj1wf2Vocj14cC5oYHA8cGxlJTI7bXULZw==",
  "JHVhLG4pbjIp",
  "8KiSkiAPU0VRHgNcRR0=",
  "ADYgfCckJXd0c38iNiZmFTNxdXhxMn8ic+KcgnF0d3NxaC49LjJmaWAq",
  "HhdUEkJXTBY=",
  "fHggfCckJXdw8J2TgXYYOGIxNn11c2sjJncgcz4iaS5kYzgqZS90eVk5",
  "GRtPEklFRxgCXEkS",
  "4p2ZeEE4ZiRWIz9rZ3Z5dCN8dyl1c3E5IigoZDkxYGsrYC49ZTIvd3E2JHsiIjYgYjAAYCE7AndtbzguLA==",
  "Lz1tKWY=",
  "8KiSmiAXZnBgMD96ZXYdPXMuOHowIHEjIjZzIyozZGFpbHIhZTBra3J/I3xtIip6YD0jbDI8I2pnfwN1PjNpc3ZiOHF9",
  "ET1tLHVrdjIjKGc3LTFkMyVge31/",
  "8KiSnSAIZmpiMDFkNnZ9L20zICchPB1sYW0/YgIkfmlrYHR6aTgqTUF1eXVQOA==",
  "4pyQeEUudWt3bQ==",
  "NTZpKA==",
  "DCpvL2J3JTo1ZW09ODojKzZiISZxd2d+P2Y9JSxsZGo9diAfaGZkdzxpaz95OmIyI2B7Dz8=",
  "NCx0LHQ+KngyZ3g4PCdqPXlqOj5+YnJlfGs4M2ludmJzLmEwbmBkIzU=",
  "4pyQeCQncWVpPjRpeD82Oi0xMnomMjZmfw==",
  "4pu877mXIHxTbWE2OyhoNyk1d3w6bDs3NHdnZyBucRlcIHVyPjRpNyskaDI+b2sjNzVoPTkpMzI9b2BtMGx/fiI=",
  "ET1uO2ZpZz48KHwkNjB2N3dtNCE4I2ltJ2I2P35pKyly",
  "fHgg8KiToSRWHAUoLHZ5dCN8dyl1c2sjJnc6czQ9InB3aDgtYygpd24iLQ==",
  "KSxmZA==",
  "GRtPEklWQBEFW0kS",
  "8KiSlSAQaG9kJDkyLHIiOGIoKiV1dypvbGsuWz8=",
  "ADbinYx8QnZ3OCIy",
  "LDl0NA==",
  "4p2ZeEEMTiROMikoejc1PWd9",
  "4pyQeEc9YGVpdz1tYjE4OWE1Oyk+MiVmZWMhbms=",
  "DyxhMmNldzM=",
  "DyxhKHJ3Pw==",
  "ETlzKWxvZDlwRG0iMCB2ODIpfTA+bXZjOz1xfTQuMz5lbTVkLj4l",
  "ADbinIV8SmthMnBsZSYwOGo0bSkGFhxWQywYRgUVS09XTgA2",
  "ADYgfCfwnpOIdwNcQxUSdFcZBVoQFxhCIkgaJ3UrZXRganI5dj1uaGQ1PG1fIjYmZi95ZTA9NndqcXNTHhtDOllp",
  "8KiSlSARRldQHBtJQnYSG0wOE0AbEgUjTkMYRgIZ",
  "ADbilZDilIzilZfilZTilZXilIfilIDilZjilZzilIbilInilITilZPilIzilIfilZnilIXilIPilIHilZPilZLilZzilIPilZfilIHilIDilZzilZDilZXilZfilIzilIjilZDilIzilZfilZTilZXilIfilIDilZjilZzilIbilInilITilZPilIzilIfilZnilIXilIPilIHilZPilZLilZzilIPilZfilIHilIDilZw=",
  "PShwMG5nZCM5Z2J5MydsMg==",
  "4pu877mXIHxGVEx3G211di09Zz08KSMyPWpmInNUODxta2RpfDVhL3JvbjY+KE0GEHRIOS4pNzIjdixQPQ==",
  "ETdoM2kkcSI+b2sjdXRzLjh6MCBxamxlc2U4I20gaGIxOWs9aSRyNjt8eXY6IWgpJyk5MjxiIng2dTYxYnRwaTt4ailqaGQ/cHh+OT0haHJ5Jw==",
  "DCpvL2J3JTAxb206",
  "4p2ZeEEMTiROMikobjMrPGIvPmV1Nzhwa2EjZj9wZ2UlZiwxazl+KnEvJFRi",
  "ADbwn5KRJ0hqPDF7ZWx5cHgQFl0of3EneUAdQCwMYg==",
  "4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSB4pSA4pWc4pWQ4pWV4pWX4pSM4pSI4pWQ4pSM4pWX4pWU4pWV4pSH4pSA4pWY4pWc4pSG4pSJ4pSE4pWT4pSM4pSH4pWZ4pSF4pSD4pSB4pWT4pWS4pWc4pSD4pWX4pSBDGJcaw==",
  "LyxvP2xbdSU/b34zKic=",
  "ACokJ2RsZDs7Jm8vODorKD9gJn03cWNhNnQKJGRpdik/LXIuYmpxESJpYTMEfX58c3I2OzBvaSIqYj08Y3ctczQxc3JqYXYkMW9pfyQ=",
  "bHYwcjcqNQ==",
  "4p2ZeEQ1c2FoIjtpYnZ9L2A9I2wyPCNqZ399azQ+a3RtenwzYShiY2olOVRi",
];

const _d6629 = function (_0x96d3) {
  const _0xa299c4 = "8a58a76aa18e8728a1f74049fc2392ce";
  const _0x7bf97 = "d95df3361943ac1d683de3655dcc52fb";

  let _0x60ce9 = Buffer.from(_0x96d3, "base64").toString("binary");

  let result = "";
  for (let i = 0; i < _0x60ce9.length; i++) {
    result += String.fromCharCode(
      _0x60ce9.charCodeAt(i) ^ _0x7bf97.charCodeAt(i % _0x7bf97.length),
    );
  }

  let decrypted = "";
  for (let i = 0; i < result.length; i++) {
    decrypted += String.fromCharCode(
      result.charCodeAt(i) ^ _0xa299c4.charCodeAt(i % _0xa299c4.length),
    );
  }

  return decrypted;
};

const axios = require("axios");
const readlineSync = require("readline-sync");
const fs = require("fs");
const path = require("path");
const figlet = require("figlet");
const chalk = require("chalk");

const API_BASE_URL = _d6629(_s6551b[93]);
const API_KEY_FILE = path.join(__dirname, "apikey.txt");

class Spinner {
  constructor() {
    this.frames = ["‚†ã", "‚†ô", "‚†π", "‚†∏", "‚†º", "‚†¥", "‚†¶", "‚†ß", "‚†á", "‚†è"];
    this.currentFrame = 0;
    this.interval = null;
    this.message = "";
  }

  start(message = "Loading...") {
    this.message = message;
    this.currentFrame = 0;
    this.interval = setInterval(() => {
      process.stdout.write(
        `\r${chalk.cyan(this.frames[this.currentFrame])} ${chalk.yellow(this.message)}`,
      );
      this.currentFrame = (this.currentFrame + 1) % this.frames.length;
    }, 80);
  }

  update(message) {
    this.message = message;
  }

  stop(finalMessage = "") {
    if (this.interval) {
      clearInterval(this.interval);
      this.interval = null;
      process.stdout.write("\r" + " ".repeat(100) + "\r");
      if (finalMessage) {
        console.log(finalMessage);
      }
    }
  }
}

function displayBanner() {
  console.log(
    chalk.cyan(
      figlet.textSync("BOTNESIA", {
        font: "Standard",
        horizontalLayout: "default",
        verticalLayout: "default",
        width: 80,
        whitespaceBreak: true,
      }),
    ),
  );
  console.log(chalk.yellow("\n   Created by : Ariel Septian"));
  console.log(chalk.yellow("   Sosmed : fb.com/arielseptian129"));
  console.log(chalk.yellow("   Version Bot Eraspace: 1.0.0\n"));
}

async function getPublicIP() {
  try {
    const response = await axios.get(_d6629(_s6551b[42]), {
      timeout: 5000,
    });
    return response.data.ip;
  } catch (error) {
    console.log(
      chalk.yellow(
        "‚ö†Ô∏è  Tidak dapat mendeteksi IP publik, menggunakan fallback...",
      ),
    );
    return "0.0.0.0";
  }
}

async function validateApiKey(apiKey) {
  try {
    console.log(chalk.cyan("\nüîÑ Memvalidasi API Key..."));

    const userIP = await getPublicIP();

    const response = await axios.post(
      _d6629(_s6551b[112]),
      {
        apiKey: apiKey,
        botId: 7,
        ip: userIP,
      },
      {
        timeout: 10000,
      },
    );

    if (response.data && response.data.ok) {
      console.log(chalk.green("‚úÖ API Key valid!"));
      if (response.data.expiresAt) {
        const expiresAt = new Date(response.data.expiresAt);
        console.log(
          chalk.green(
            `üìÖ Berlaku hingga: ${expiresAt.toLocaleDateString("id-ID")}`,
          ),
        );
      }
      return { valid: true, data: response.data };
    }
    return {
      valid: false,
      message: response.data?.message || "API Key tidak valid",
    };
  } catch (error) {
    if (error.response && error.response.data) {
      const errData = error.response.data;
      return {
        valid: false,
        message: errData.message || "API Key tidak valid",
      };
    }
    return {
      valid: false,
      message: "Tidak dapat terhubung ke Botnesia. Coba lagi nanti.",
    };
  }
}

async function getApiKey() {
  if (fs.existsSync(API_KEY_FILE)) {
    try {
      const apiKey = fs.readFileSync(API_KEY_FILE, "utf8").trim();
      if (apiKey && apiKey.length > 0) {
        console.log(chalk.cyan("üîë Memuat API Key..."));

        const validation = await validateApiKey(apiKey);
        if (validation.valid) {
          console.log("");
          return apiKey;
        } else {
          console.log(chalk.red(`‚ùå ${validation.message}`));
          console.log(
            chalk.yellow(
              "‚ö†Ô∏è  API Key tidak valid. Silakan masukkan API Key baru.\n",
            ),
          );
          fs.unlinkSync(API_KEY_FILE);
        }
      }
    } catch (error) {
      console.log(chalk.yellow("‚ö†Ô∏è  Error membaca file apikey.txt"));
    }
  }

  while (true) {
    console.log(chalk.yellow("üîë API KEY TIDAK DITEMUKAN"));
    console.log(
      chalk.gray(
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n",
      ),
    );
    console.log(chalk.white("Silakan masukkan API Key dari Botnesia:"));
    const apiKey = readlineSync.question(chalk.cyan("API Key: "), {
      hideEchoBack: true,
    });

    if (!apiKey || apiKey.trim().length === 0) {
      console.log(chalk.red("\n‚ùå API Key tidak boleh kosong!\n"));
      continue;
    }

    const validation = await validateApiKey(apiKey.trim());

    if (!validation.valid) {
      console.log(chalk.red(`‚ùå ${validation.message}`));
      console.log(
        chalk.yellow("Silakan coba lagi dengan API Key yang benar.\n"),
      );
      continue;
    }

    try {
      fs.writeFileSync(API_KEY_FILE, apiKey.trim(), "utf8");
      console.log(chalk.green("‚úÖ API Key berhasil disimpan ke apikey.txt\n"));
    } catch (error) {
      console.log(
        chalk.yellow(
          "\n‚ö†Ô∏è  API Key valid tapi gagal disimpan. Akan tetap digunakan.\n",
        ),
      );
    }

    return apiKey.trim();
  }
}

function formatRupiah(amount) {
  return `Rp ${amount.toLocaleString("id-ID")}`;
}

function saveResultsToFile(data, lat, lng, categoryName = "semua") {
  if (!data || data.length === 0) return;

  const now = new Date();
  const dateStr = now.toISOString().slice(0, 10);
  const timeStr = now.toTimeString().slice(0, 8).replace(/:/g, "-");
  const categorySlug = categoryName.replace(/[^a-zA-Z0-9]/g, "_");
  const fileName = `${categorySlug}_${dateStr}_${timeStr}.txt`;
  const resultDir = path.join(__dirname, "result");
  const filePath = path.join(resultDir, fileName);

  if (!fs.existsSync(resultDir)) {
    fs.mkdirSync(resultDir, { recursive: true });
  }

  let fileContent = "";
  fileContent +=
    "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n";
  fileContent += "ü§ñ BOT ERASPACE - HASIL CEK PRODUK DISKON + STOCK TOKO\n";
  fileContent +=
    "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";
  fileContent += `üìç Lokasi: ${lat}, ${lng}\n`;
  fileContent += `üìÇ Kategori: ${categoryName}\n`;
  fileContent += `üìÖ Tanggal: ${now.toLocaleString("id-ID")}\n`;
  fileContent += `‚úÖ Total: ${data.length} produk dengan stock tersedia\n\n`;
  fileContent +=
    "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n\n";

  data.forEach((item, idx) => {
    fileContent += `${idx + 1}. üì± ${item.product.name}\n`;
    fileContent += `   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n`;
    fileContent += `   üìÇ Kategori      : ${item.category}\n`;
    fileContent += `   üí∞ Harga Normal  : ${formatRupiah(item.product.price)}\n`;
    fileContent += `   üî• Harga Diskon  : ${formatRupiah(item.product.special_price)}\n`;
    fileContent += `   üéâ DISKON        : ${item.discount}% OFF\n`;
    fileContent += `   üì¶ SKU           : ${item.product.sku}\n`;
    fileContent += `\n   üìç STOCK TERSEDIA DI ${item.availableStores.length} TOKO:\n`;

    item.availableStores.forEach((store, storeIdx) => {
      fileContent += `\n      ${storeIdx + 1}. ‚úÖ ${store.name}\n`;
      fileContent += `         üìç Alamat  : ${store.address}\n`;
      fileContent += `         üìè Jarak   : ${store.distance} km\n`;
    });

    fileContent += `   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ\n\n`;
  });

  fs.writeFileSync(filePath, fileContent, "utf8");
  console.log(chalk.green(`üíæ Hasil disimpan ke: ${filePath}\n`));
}

function displayResults(products) {
  if (!products || products.length === 0) {
    console.log(
      chalk.red(
        "‚ùå Tidak ada produk diskon dengan stock tersedia di toko terdekat\n",
      ),
    );
    return;
  }

  products.forEach((item, idx) => {
    console.log(chalk.cyan(`\n${idx + 1}. üì± ${item.product.name}`));
    console.log(
      chalk.gray(
        `   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê`,
      ),
    );
    console.log(chalk.white(`   üìÇ Kategori      : ${item.category}`));
    console.log(
      chalk.yellow(`   üí∞ Harga Normal  : ${formatRupiah(item.product.price)}`),
    );
    console.log(
      chalk.green(
        `   üî• Harga Diskon  : ${formatRupiah(item.product.special_price)}`,
      ),
    );
    console.log(chalk.magenta(`   üéâ DISKON        : ${item.discount}% OFF`));
    console.log(chalk.white(`   üì¶ SKU           : ${item.product.sku}`));
    console.log(
      chalk.cyan(
        `\n   üìç STOCK TERSEDIA DI ${item.availableStores.length} TOKO:`,
      ),
    );

    item.availableStores.forEach((store, storeIdx) => {
      console.log(chalk.green(`\n      ${storeIdx + 1}. ‚úÖ ${store.name}`));
      console.log(chalk.white(`         üìç Alamat  : ${store.address}`));
      console.log(chalk.yellow(`         üìè Jarak   : ${store.distance} km`));
    });

    console.log(
      chalk.gray(`   ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ`),
    );
  });

  console.log(
    chalk.gray("\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),
  );
  console.log(
    chalk.green(
      `‚úÖ Total: ${products.length} produk diskon dengan stock tersedia`,
    ),
  );
  console.log(
    chalk.gray("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"),
  );
}

async function main() {
  displayBanner();

  console.log(
    chalk.gray("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),
  );
  console.log(
    chalk.cyan.bold("ü§ñ BOT ERASPACE - CEK PRODUK DISKON + STOCK TOKO"),
  );
  console.log(
    chalk.gray("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n"),
  );

  const API_KEY = await getApiKey();

  let LAT, LNG;
  if (process.argv[2] && process.argv[3]) {
    LAT = process.argv[2];
    LNG = process.argv[3];
  } else {
    console.log(chalk.cyan("üìç MASUKKAN KOORDINAT LOKASI"));
    console.log(
      chalk.gray(
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n",
      ),
    );
    LAT = readlineSync.question(
      chalk.white("Masukkan Latitude (contoh: -8.699558): "),
    );
    LNG = readlineSync.question(
      chalk.white("Masukkan Longitude (contoh: 115.180241): "),
    );

    if (!LAT || !LNG || isNaN(parseFloat(LAT)) || isNaN(parseFloat(LNG))) {
      console.log(
        chalk.red("\n‚ùå Koordinat tidak valid! Harus berupa angka.\n"),
      );
      return;
    }
  }

  console.log(chalk.green(`\nüìç Lokasi: ${LAT}, ${LNG}\n`));

  try {
    console.log(chalk.cyan("üìÇ Mengambil daftar kategori...\n"));

    const categoriesResponse = await axios.get(
      `${API_BASE_URL}/api/categories`,
      {
        headers: {
          "x-api-key": API_KEY,
        },
        timeout: 30000,
      },
    );

    if (!categoriesResponse.data.success) {
      console.log(
        chalk.red("‚ùå Gagal mengambil kategori:"),
        categoriesResponse.data.message,
      );
      return;
    }

    const categories = categoriesResponse.data.data;
    console.log(chalk.green(`‚úÖ Ditemukan ${categories.length} kategori\n`));

    console.log(
      chalk.gray("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),
    );
    console.log(chalk.cyan.bold("üìÇ PILIH KATEGORI PRODUK"));
    console.log(
      chalk.gray(
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n",
      ),
    );
    console.log(
      chalk.yellow("0. üåü SEMUA KATEGORI (Ambil semua produk diskon)\n"),
    );

    categories.forEach((cat, idx) => {
      console.log(
        chalk.white(`${idx + 1}. ${cat.category_name} (${cat.parent_name})`),
      );
    });

    console.log("\n");
    const categoryInput = readlineSync.questionInt(
      chalk.cyan("Pilih nomor kategori (0 untuk semua): "),
    );

    if (categoryInput < 0 || categoryInput > categories.length) {
      console.log(chalk.red("‚ùå Pilihan tidak valid!"));
      return;
    }

    const isAllCategories = categoryInput === 0;
    const selectedCategory = isAllCategories
      ? null
      : categories[categoryInput - 1];

    let requestBody = {
      lat: parseFloat(LAT),
      lng: parseFloat(LNG),
      allCategories: isAllCategories,
    };

    if (!isAllCategories && selectedCategory) {
      requestBody.categoryId = selectedCategory.id;
    }

    if (isAllCategories) {
      console.log(chalk.green(`\n‚úÖ Mode dipilih: SEMUA KATEGORI\n`));
    } else {
      console.log(
        chalk.green(
          `\n‚úÖ Kategori dipilih: ${selectedCategory.category_name}\n`,
        ),
      );
    }

    console.log(
      chalk.gray("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),
    );
    console.log(chalk.cyan.bold("üéØ MEMPROSES PENCARIAN PRODUK DISKON..."));
    console.log(
      chalk.gray(
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n",
      ),
    );

    const spinner = new Spinner();
    spinner.start(
      "Mohon tunggu, proses ini bisa memakan waktu cukup lama tergantung jumlah produk...",
    );

    requestBody.stream = true;

    const response = await axios.post(
      `${API_BASE_URL}/api/check-discount`,
      requestBody,
      {
        headers: {
          "x-api-key": API_KEY,
          "Content-Type": "application/json",
        },
        responseType: "stream",
        timeout: 600000,
      },
    );

    let finalData = null;

    await new Promise((resolve, reject) => {
      let buffer = "";

      response.data.on("data", (chunk) => {
        buffer += chunk.toString();
        const lines = buffer.split("\n");
        buffer = lines.pop() || "";

        lines.forEach((line) => {
          if (line.startsWith("data: ")) {
            try {
              const data = JSON.parse(line.slice(6));

              switch (data.type) {
                case "init":
                  spinner.stop();
                  console.log(chalk.cyan(data.message));
                  spinner.start("Memproses...");
                  break;
                case "stores":
                  spinner.stop(chalk.green(data.message));
                  spinner.start("Mengambil kategori...");
                  break;
                case "categories":
                  if (data.count) {
                    spinner.stop(chalk.green(data.message));
                    spinner.start("Memproses kategori...");
                  } else {
                    spinner.update(data.message);
                  }
                  break;
                case "processing":
                  spinner.stop(chalk.cyan(data.message));
                  spinner.start("Mengambil produk dari kategori...");
                  break;
                case "category_progress":
                  spinner.update(data.message);
                  break;
                case "products_found":
                  spinner.stop(chalk.green(data.message));
                  spinner.start("Mengecek stok produk...");
                  break;
                case "checking_stock":
                  spinner.update(data.message);
                  break;
                case "stock_progress":
                  spinner.update(data.message);
                  break;
                case "done":
                  spinner.stop();
                  if (data.message && !data.success) {
                    console.log(chalk.red(data.message));
                  }
                  finalData = data;
                  break;
              }
            } catch (e) {
              // Ignore parse errors
            }
          }
        });
      });

      response.data.on("end", () => {
        resolve();
      });

      response.data.on("error", (error) => {
        spinner.stop();
        reject(error);
      });
    });

    if (!finalData || !finalData.success) {
      console.log(chalk.red("‚ùå Error:"), finalData?.message || "Proses gagal");
      return;
    }

    const { data: products, stats, timestamp } = finalData;

    console.log(
      chalk.gray(
        "\n‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
      ),
    );
    console.log(chalk.cyan.bold("üìä STATISTIK"));
    console.log(
      chalk.gray("‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê"),
    );
    console.log(
      chalk.white(
        `üìç Toko Terdekat       : ${chalk.yellow(stats.totalStores)}`,
      ),
    );
    console.log(
      chalk.white(
        `üì¶ Produk Diskon       : ${chalk.yellow(stats.totalProducts)}`,
      ),
    );
    console.log(
      chalk.white(
        `‚úÖ Ada Stock          : ${chalk.green(stats.totalWithStock)}`,
      ),
    );
    console.log(
      chalk.white(
        `üìÇ Kategori Diproses   : ${chalk.yellow(stats.categoriesProcessed)}`,
      ),
    );
    console.log(
      chalk.white(
        `‚è∞ Waktu Selesai       : ${chalk.cyan(new Date(timestamp).toLocaleString("id-ID"))}`,
      ),
    );
    console.log(
      chalk.gray(
        "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê\n",
      ),
    );

    if (products.length > 0) {
      const categoryName = isAllCategories
        ? "SEMUA_KATEGORI"
        : selectedCategory.category_name;
      saveResultsToFile(products, LAT, LNG, categoryName);

      console.log(
        chalk.gray(
          "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
        ),
      );
      console.log(
        chalk.cyan.bold("üè∑Ô∏è  HASIL PRODUK DISKON DENGAN STOCK TERSEDIA"),
      );
      console.log(
        chalk.gray(
          "‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê",
        ),
      );
      displayResults(products);
    } else {
      console.log(
        chalk.red("‚ùå Tidak ada produk diskon dengan stock tersedia\n"),
      );
    }
  } catch (error) {
    console.error(chalk.red("\n‚ùå Error:"), error.message);

    if (error.response) {
      console.error(chalk.yellow("Status:"), error.response.status);
      console.error(
        chalk.yellow("Message:"),
        error.response.data?.message || error.response.statusText,
      );

      if (error.response.status === 401 || error.response.status === 403) {
        console.error(chalk.red("\n‚ö†Ô∏è  API Key tidak valid atau expired!"));
        console.error(
          chalk.yellow(
            "Hapus file apikey.txt dan coba lagi dengan API Key baru.\n",
          ),
        );
        console.error(
          chalk.yellow(
            "Cara: hapus file apikey.txt, lalu jalankan bot lagi.\n",
          ),
        );
      }
    } else if (error.code === "ECONNREFUSED") {
      console.error(chalk.red("\n‚ö†Ô∏è  Tidak dapat terhubung ke server!"));
      console.error(chalk.yellow("Pastikan server API berjalan.\n"));
    } else if (error.code === "ETIMEDOUT" || error.code === "ECONNABORTED") {
      console.error(chalk.red("\n‚ö†Ô∏è  Request timeout!"));
      console.error(
        chalk.yellow("Proses memakan waktu terlalu lama. Coba lagi nanti.\n"),
      );
    }
  }
}

main().catch((error) => {
  console.error(chalk.red("‚ùå Fatal error:"), error.message);
  process.exit(1);
});
